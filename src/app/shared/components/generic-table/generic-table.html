<div class="overflow-hidden bg-slate-800/40 border border-slate-700/50 rounded-3xl shadow-2xl backdrop-blur-md">
    <div class="overflow-x-auto">
        <table class="w-full text-left border-collapse">
            <thead>
                <tr class="bg-slate-800/60 border-b border-slate-700">
                    @for (col of columns; track col.key) {
                    <th class="px-6 py-4 text-xs font-bold text-slate-400 uppercase tracking-widest">
                        {{ col.label }}
                    </th>
                    }

                    @if (actions && actions.length > 0) {
                    <th class="px-6 py-4 text-xs font-bold text-slate-400 uppercase tracking-widest text-right">
                        Acciones
                    </th>
                    }
                </tr>
            </thead>
            <tbody class="divide-y divide-slate-700/50 relative">

                @if (loading) {
                    @for (i of [1,2,3,4,5]; track i) {
                    <tr class="animate-pulse">
                        @for (col of columns; track col.key) {
                        <td class="px-6 py-5">
                            <div class="h-2.5 bg-slate-700/50 rounded-full w-24"></div>
                        </td>
                        }
                        @if (actions && actions.length > 0) {
                        <td class="px-6 py-5 flex justify-end">
                            <div class="h-8 w-8 bg-slate-700/50 rounded-lg"></div>
                        </td>
                        }
                    </tr>
                    }
                } @else {
                    @for (row of data; track row.id) {
                    <tr class="hover:bg-indigo-500/5 transition-all duration-200 group border-l-2 border-transparent hover:border-l-indigo-500">
                        @for (col of columns; track col.key) {
                        <td class="px-6 py-4 whitespace-nowrap">
                            @if (col.key === 'isDeleted' || col.key === 'isActive') {
                                @let isActive = col.key === 'isDeleted' ? !row[col.key] : row[col.key];
                                
                                <span [class]="isActive 
                                        ? 'bg-emerald-500/10 text-emerald-400 border-emerald-500/20 shadow-[0_0_10px_rgba(16,185,129,0.1)]' 
                                        : 'bg-rose-500/10 text-rose-400 border-rose-500/20 shadow-[0_0_10px_rgba(244,63,94,0.1)]'"
                                    class="text-[10px] uppercase font-bold px-2.5 py-1 rounded-full border inline-flex items-center gap-1.5 backdrop-blur-sm">

                                    <span class="w-1.5 h-1.5 rounded-full"
                                        [class]="isActive ? 'bg-emerald-400 shadow-[0_0_5px_#34d399]' : 'bg-rose-400 shadow-[0_0_5px_#f43f5e]'"></span>

                                    {{ isActive ? 'Activo' : 'Inactivo' }}
                                </span>
                            } @else {
                                <span class="text-sm font-medium text-slate-300 group-hover:text-white transition-colors {{ col.class }}">
                                    {{ row[col.key] }}
                                </span>
                            }
                        </td>
                        }

                        @if (actions && actions.length > 0) {
                        <td class="px-6 py-4 text-right">
                            <div class="flex justify-end gap-1">
                                @for (action of actions; track action.tooltip) {
                                    @if (!action.permission || auth.hasPermission(action.permission)) {
                                    <button (click)="action.callback(row)"
                                        class="p-2 rounded-xl transition-all hover:bg-slate-700/50 text-slate-400 hover:text-white {{ action.colorClass }}"
                                        [title]="action.tooltip">
                                        <span class="material-icons text-[20px]">{{ action.icon }}</span>
                                    </button>
                                    }
                                }
                            </div>
                        </td>
                        }
                    </tr>
                    } @empty {
                    <tr>
                        <td [attr.colspan]="columns.length + (actions.length > 0 ? 1 : 0)" class="px-6 py-20 text-center">
                            <div class="flex flex-col items-center opacity-30">
                                <span class="material-icons text-5xl mb-3 text-slate-500">inventory_2</span>
                                <p class="italic text-slate-400 font-medium">No hay registros disponibles</p>
                            </div>
                        </td>
                    </tr>
                    }
                }
            </tbody>
        </table>

        @if (pagination && !loading && data.length > 0) {
        <div class="flex justify-between items-center px-6 py-4 border-t border-slate-700/50 bg-slate-900/40">
            <span class="text-xs font-bold text-slate-500 uppercase tracking-widest">
                PÃ¡gina <span class="text-indigo-400">{{ currentPage }}</span>
            </span>
            <div class="flex gap-2">
                <button [disabled]="currentPage === 1" (click)="pageChange.emit(currentPage - 1)"
                    class="p-2 rounded-xl border border-slate-700 text-slate-400 hover:bg-slate-700 hover:text-white disabled:opacity-10 disabled:cursor-not-allowed transition-all">
                    <span class="material-icons">chevron_left</span>
                </button>
                <button (click)="pageChange.emit(currentPage + 1)"
                    class="p-2 rounded-xl border border-slate-700 text-slate-400 hover:bg-slate-700 hover:text-white transition-all">
                    <span class="material-icons">chevron_right</span>
                </button>
            </div>
        </div>
        }
    </div>
</div>